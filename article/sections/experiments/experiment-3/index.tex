\input{tables/dut-2-exp-3-nb.tex}
\subsection{Experiment Three}\label[subsec]{subsec:exp_three}

The third experiment investigated \cref{RQ:RQ3,RQ:RQ4}, by taking a look at the per-core performance. In this experiment only IPG and the Clamp were used to conduct measurements, as a result of the findings in \cref{subsec:exp_two}. This experiment explored what benefit macrobenchmarks gained from additional allocated cores, by executing PCM and 3DM on an increasing number of cores. Before this is done, an analysis on the per-core performance of both CPUs was conducted, where the single-core benchmarks introduced in \cref{subsec:test_cases} were used. This allowed a comparison between the energy consumption of the P- and E-cores on DUT 2 and the P-cores on DUT 1. When the measurements were performed, the limit of $1.000$ measurements set in \cref{subsec:exp_two} was still used.

%The benchmark used in this experiment was the single-core benchmarks introduced in \cref{subsec:test_cases}, by running each benchmark on one core at a time, while measuring the energy consumption using IPG and Clamp. This will show how the performance is between P- and E-cores, and how the performance is between cores with the same specifications.

\input{tables/dut-2-exp-3.tex}
\paragraph{Per-Core Initial Measurements:} An initial $250$ measurements were made for each benchmark on each core. After, Cochran's formula was applied to the result to determine if more measurements were required. The results from this can be found in \cref{app:exp_three_coch}.

%The first measurements were made, will be in order to compare the per-core performance, where $250$ measurements will be made for each benchmark on each core. After $250$ measurements, more measurements were made where it was required, as can be found in \cref{app:exp_three_coch}, with an upper limit of $1000$ measurements.



\paragraph{Per-Core Results:} For the per-core results, the analysis was based on DUT 2 when executing SN, with the results from the other DUT and benchmarks found in \cref{app:exp_three}. When comparing different cores on the same CPU, the largest difference was found on DUT 1 with benchmark NB, where the performance was $11.61\%$ worse on core $1$ than core $6$, while The smallest difference was found on DUT 2, benchmark NB on a E core, where the energy consumption was $1.17\%$ higher on core $6$ than core $9$.

When comparing the difference in performance between P- and E cores, \cref{tab:dut-2-exp-3-sn} illustrates the performance difference between an average P and E core on DUT 2. \cref{tab:dut-2-exp-3-sn} illustrates that the run time on average was $76.32\%$ lower on P-cores compared to the E-cores and the total DEC was on average $94.59\%$ lower on P cores. For the DEC per second however, P cores had a $254.71\%$ higher consumption. 

% \cref{tab:dut-2-exp-3-sn} illustrated a higher difference between the DEC ($-93.59\%$) than the total energy consumption ($-70.45\%$) between P- and E cores. This is a result of DEC excluding the idle energy consumption from the measurements, resulting in lower values, but a larger percent difference. %When comparing  P- and E-cores, the execution time is on average is $76.26\%$ lower on P cores, the energy consumption is $70.44\%$ lower on P cores over the entire execution time, while E cores has a $72.88\%$ lower energy consumption per second.
% The largest difference between two cores of the same type was found on DUT 1 with benchmark NB, where the performance was $11.61\%$ worse on core 1 than core 6. The smallest difference was found on DUT 2, benchmark NB on a E core, where the energy consumption was $1.17\%$ higher on core $6$ than core $9$.


%When comparing cores of the same type, the largest difference between the best and worst performing core was found on DUT 2, with benchmark NB, 



% dut 1, NB: 11.61 2 and 7
% dut 1, SN: 2.5
% dut 2, NB: E:3.38, P: 1.17
% dut 2, SN: E: 1.26, P:2.35
\input{tables/experiment-3/app-3-x-axis-dut-2-3dm.tex}

\paragraph*{Macrobenchmark Initial Measurements:} following the analysis of the per-core performance, the two macrobenchmarks introduced in \cref{subsec:test_cases} will be executed on an increasing number of cores, starting from the most efficient. An initial $30$ measurements will be made, as the per-core experiment illustrated how $250$ were too much for DUT 2, illustrated in \cref{app:exp_three_coch}. The initial idea was to start at one core, which is done for 3DM for both DUTs and PCM on DUT 1. On DUT 2, PCM could not execute web browsing on a single core, and was unable to execute spreadsheet and photo editing. Because of this, DUT 2 will start at 2 cores. For DUT 1, web browsing was unable to execute, so this scenario is excluded for this DUT. Despite attempts, we were unable to figure out why PCM had were unable to run certain scenarios on few cores, as no error logs were created when the error occured and the error was presented as an unknown error by PCM. After the initial $30$ measurements, Cochrans formula was applied to the data, to take additional measurements if required. The amount of required measurements can be found in \cref{app:exp_three_coch_app}.


\paragraph*{Macrobenchmark Results:} The results for DUT 1 can be seen in \cref{fig:exp_3_dut_2_3dm_result} and \cref{fig:exp_3_dut_2_pcm_result} for 3DM and PCM respectively, and for DUT 1 in \cref{app:app_exp_three}. In \cref{app:exp-3-table-res} the percent the performance gains is illustrated in percentages for both DUTs and benchmarks. 

\input{tables/experiment-3/app-3-x-axis-dut-2-pcm.tex}

For both DUTs and macrobenchmarks, a similar observation was made, where the execution time and DEC decreases and the DEC per second increases, as more cores were allocated. It can be seen in \cref{tab:app-results} how the execution time decrease more than the DEC which shows a diminishing return in terms of energy savings. A difference between 3DM and PCM is how the execution time and energy consumption decrease more for 3DM that for PCM, which is because PCM include scenarios which were single thread tasks. This meant that only a part of the benchmarks can benefit from the additional allocated cores, and even for those parts benefitting, the performance gained from the last few allocated cores was limited. For 3DM, the benchmark itself was embarrassingly parallel, but the measurements included a startup and shutdown period which is not. This means the numbers reported in \cref{fig:exp_3_dut_2_3dm_result} would be even higher if the parallel part were isolated. The diminishing return gained from allocating more resources to PCM is also illustrated, discussed and compared to 3DM in \cref{app:timeseries}.

\input{tables/results/compare-p-and-e-cores-on-pcmark-without-boost/ipg/pc-mark-10/workstationtwo/unkown/CPU_DEC.tex}

\paragraph{P vs. E Initial Measurements:} when the macrobenchmarks were executed on an increasing number of cores, the E cores were the least effective and thus the last four. This showed that when comparing the energy consumption, it is higher on E cores, despite a lower DEC per second. As was presented in \cref{subsec:P_E_Cores}, the point of a E cores are for small non-critical jobs. In this experiment, PCM will be run on four cores, either with four P cores (4P), four E cores (4E) or two of each (2P2E), to emulate a more realistic setting where E cores could flourish. This was because PCM would not utilize the entire CPU, meaning that the P and E cores could be used when the OS sees it fit. For this experiment, $30$ initial measurements were made, and additional were made after Cochran's formula was applied to the results, if required. This can be found in \cref{app:p-vs-e}.


\paragraph{P vs. E Results:} The results for the execution time and DEC can be seen in  \cref{fig:3-compare-p-and-e-cores-on-pcmark-without-boost-ipg-pc-mark-10.exe-unkown-workstationtwo-runtime-duration} and  \cref{fig:3-compare-p-and-e-cores-on-pcmark-without-boost-ipg-pc-mark-10.exe-unkown-workstationtwo-cpu-dec} respectively, while the DEC per second can be found in \cref{app:bonus-results}. When looking at the DEC and execution time, 4E had a higher execution time and DEC, while 4P has the lowest. When combining P- and E cores, the execution time was $3.8\%$ higher and the DEC was $0.23\%$ higher compared to 4P. While this still showed that P cores performed best, it also showed an almost equivalent performance despite two cores having a lower frequency.

\input{tables/results/compare-p-and-e-cores-on-pcmark-without-boost/ipg/pc-mark-10/workstationtwo/unkown/Runtime_duration.tex}

%% pcmark for dut 1: video conf, web brows, spredsheets, photo edit, video edit, render
%% pcmark for dut 2: video conf, web brows, vidoe editing, render